---
import { Font } from "astro:assets";
import "../styles/global.css";
import { ModeToggle } from "@/components/ui/ModeToggle";
import KnotsAnim from "@/components/ui-3d/KnotsAnim.astro";
const { content } = Astro.props;
import { ClientRouter } from "astro:transitions";
import JellyHead from "@/components/ui-3d/JellyHead";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>{content.title}</title>

    <ClientRouter />

    <!-- Load the fonts -->
    <Font cssVariable="--font-montserrat" />
    <Font cssVariable="--font-eb-garamond" />
    <Font cssVariable="--font-inconsolata" />

    <!-- Prevent FOUC by setting theme immediately -->
    <script is:inline>
      (function () {
        const savedTheme = localStorage.getItem("theme");
        const systemPrefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;

        // Determine the effective theme
        let theme = "light";
        if (savedTheme === "dark" || savedTheme === "light") {
          theme = savedTheme;
        } else if (systemPrefersDark) {
          theme = "dark";
        }

        // Apply theme class immediately
        document.documentElement.classList.add(theme);
      })();
    </script>
  </head>
  <body>
    <!-- <KnotsAnim /> -->
    <JellyHead client:load />
    <div class="fixed top-4 right-4 z-50 print:hidden">
      <ModeToggle client:only />
    </div>
    <slot />
  </body>
</html>
